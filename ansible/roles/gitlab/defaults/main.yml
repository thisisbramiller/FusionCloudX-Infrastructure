---
# ==============================================================================
# GitLab Role - Default Variables
# ==============================================================================

# GitLab Edition
gitlab_edition: "gitlab-ce"  # Community Edition

# GitLab Version (empty = latest)
gitlab_version: ""

# Domain configuration
gitlab_domain: "fusioncloudx.home"
gitlab_hostname: "gitlab"
gitlab_enable_https: true  # Enable HTTPS configuration
gitlab_external_url: "{{ 'https' if gitlab_enable_https else 'http' }}://{{ gitlab_hostname }}.{{ gitlab_domain }}"

# SSL/TLS configuration (used when gitlab_enable_https is true)
gitlab_ssl_certificate: "/etc/ssl/certs/server.crt"
gitlab_ssl_certificate_key: "/etc/ssl/private/server.key"
gitlab_ssl_protocols: "TLSv1.2 TLSv1.3"
gitlab_ssl_ciphers: "ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256"
gitlab_ssl_prefer_server_ciphers: "on"

# HSTS (HTTP Strict Transport Security) configuration
gitlab_hsts_max_age: 31536000  # 1 year in seconds
gitlab_hsts_include_subdomains: false

# Memory-constrained configuration
gitlab_memory_constrained: true
gitlab_puma_workers: 0  # Disabled for memory constraints (single process)
gitlab_sidekiq_concurrency: 10
gitlab_prometheus_enabled: false

# Email configuration
gitlab_email_enabled: true
gitlab_email_from: "gitlab@{{ gitlab_domain }}"
gitlab_email_display_name: "GitLab"

# Backup configuration
gitlab_backup_enabled: true
gitlab_backup_path: "/var/opt/gitlab/backups"
gitlab_backup_keep_time: 604800  # 7 days in seconds

# Firewall rules
gitlab_firewall_rules:
  - rule: allow
    port: '80'
    proto: tcp
    comment: "GitLab HTTP"
  - rule: allow
    port: '443'
    proto: tcp
    comment: "GitLab HTTPS"
  - rule: allow
    port: '22'
    proto: tcp
    comment: "GitLab SSH"

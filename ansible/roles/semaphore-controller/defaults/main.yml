---
# ==============================================================================
# Semaphore Controller Role - Default Variables
# ==============================================================================
# This role configures semaphore-ui VM as the Infrastructure Control Plane
# ==============================================================================

# Infrastructure repository configuration
infra_repo_url: "git@github.com:thisisbramiller/FusionCloudX-Infrastructure.git"
infra_repo_path: "/opt/infrastructure"
infra_repo_branch: "main"

# Ansible user configuration
ansible_user_name: "ansible"
ansible_user_home: "/home/ansible"

# SSH key configuration
ssh_key_type: "ed25519"
ssh_key_comment: "ansible@semaphore-ui-control-plane"
ssh_management_key_path: "{{ ansible_user_home }}/.ssh/id_ed25519"
ssh_github_deploy_key_path: "{{ ansible_user_home }}/.ssh/github_deploy_key"
ssh_proxmox_key_path: "{{ ansible_user_home }}/.ssh/proxmox_terraform_key"

# Terraform configuration
terraform_version: "1.10.3"
terraform_install_path: "/usr/local/bin"
terraform_gpg_key_url: "https://apt.releases.hashicorp.com/gpg"
terraform_repo_url: "https://apt.releases.hashicorp.com"

# 1Password CLI configuration
onepassword_cli_version: "2.30.3"
onepassword_cli_arch: "amd64"
onepassword_cli_install_path: "/usr/local/bin"
onepassword_cli_url: "https://cache.agilebits.com/dist/1P/op2/pkg/v{{ onepassword_cli_version }}/op_linux_{{ onepassword_cli_arch }}_v{{ onepassword_cli_version }}.zip"

# 1Password Connect configuration (if using Connect Server instead of CLI)
onepassword_connect_enabled: false
onepassword_connect_host: ""
onepassword_connect_token: ""

# Environment variables
environment_vars:
  OP_SERVICE_ACCOUNT_TOKEN: "{{ onepassword_service_account_token | default('') }}"
  PROXMOX_VE_ENDPOINT: "{{ proxmox_api_url | default('https://192.168.40.206:8006') }}"
  ANSIBLE_HOST_KEY_CHECKING: "False"

# Semaphore UI configuration
semaphore_version: "latest"
semaphore_install_path: "/usr/local/bin"
semaphore_config_path: "/etc/semaphore"
semaphore_web_root: "/usr/local/share/semaphore/public"
semaphore_port: 3000
semaphore_admin_user: "admin"
semaphore_admin_email: "admin@fusioncloudx.home"
semaphore_admin_name: "FusionCloudX Admin"

# PostgreSQL database configuration
semaphore_db_host: "postgresql.fusioncloudx.home"
semaphore_db_port: 5432
semaphore_db_name: "semaphore"
semaphore_db_user: "semaphore"
# Database password should be retrieved from 1Password
semaphore_db_password: "{{ lookup('onepassword.connect.generic', 'semaphore-db-password', vault='homelab') | default('changeme') }}"

# Ansible collections to install
ansible_collections:
  - name: onepassword.connect
    version: ">=2.3.1"
  - name: community.general
    version: ">=10.0.0"
  - name: community.postgresql
    version: ">=3.0.0"

# Managed hosts for SSH key distribution
# These hosts will receive the ansible user's public SSH key
managed_hosts: []
# Example:
#   - hostname: "teleport"
#     ansible_host: "192.168.1.101"
#   - hostname: "wazuh"
#     ansible_host: "192.168.1.103"
